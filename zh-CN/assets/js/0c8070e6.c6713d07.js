"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["583282"],{534663:function(e,n,r){r.r(n),r.d(n,{default:()=>u,frontMatter:()=>t,metadata:()=>i,assets:()=>o,toc:()=>c,contentTitle:()=>a});var i=JSON.parse('{"id":"query/query-analysis/get-profile","title":"\u83B7\u53D6 Profile","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.0/query/query-analysis/get-profile.md","sourceDirName":"query/query-analysis","slug":"/query/query-analysis/get-profile","permalink":"/zh-CN/docs/2.0/query/query-analysis/get-profile","draft":false,"unlisted":false,"tags":[],"version":"2.0","frontMatter":{"title":"\u83B7\u53D6 Profile","language":"zh-CN"}}'),s=r("785893"),l=r("250065");let t={title:"\u83B7\u53D6 Profile",language:"zh-CN"},a=void 0,o={},c=[{value:"\u80CC\u666F",id:"\u80CC\u666F",level:2},{value:"\u8BF7\u6C42",id:"\u8BF7\u6C42",level:2},{value:"Doris \u96C6\u7FA4\u80FD\u591F\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51",id:"doris-\u96C6\u7FA4\u80FD\u591F\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51",level:2},{value:"Doris \u96C6\u7FA4\u8BBF\u95EE\u5916\u7F51\u53D7\u5230\u9650\u5236",id:"doris-\u96C6\u7FA4\u8BBF\u95EE\u5916\u7F51\u53D7\u5230\u9650\u5236",level:2}];function d(e){let n={code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u80CC\u666F",children:"\u80CC\u666F"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u65F6\u5E38\u9047\u5230\u5BF9\u5E94 SQL \u6267\u884C\u65F6\u95F4\u4E0D\u53CA\u9884\u671F\u7684\u60C5\u51B5\uFF0C\u4E3A\u4E86\u4F18\u5316 SQL \u8FBE\u5230\u9884\u671F\u67E5\u8BE2\u65F6\u5EF6\uFF0C\u901A\u8FC7 Profile \u6211\u4EEC\u80FD\u591F\u770B\u51FA\u53EF\u4EE5\u505A\u54EA\u4E9B\u4F18\u5316\u3002\u73B0\u5728\u8BF4\u660E\u5728\u4E0D\u540C\u73AF\u5883\u4E0B\u5E94\u8BE5\u5982\u4F55\u62FF\u5230\u5BF9\u5E94 Query \u7684 Profile\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u8BF7\u6C42",children:"\u8BF7\u6C42"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"HTTP://FE_IP:HTTP_PORT"}),"\n",(0,s.jsx)(n.code,{children:"GET /API/Profile"})]}),"\n",(0,s.jsx)(n.h2,{id:"doris-\u96C6\u7FA4\u80FD\u591F\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51",children:"Doris \u96C6\u7FA4\u80FD\u591F\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u5F00\u542F Profile \u4E0A\u62A5\u53C2\u6570 enable_profile"}),"\n",(0,s.jsx)(n.p,{children:"\u8BE5\u53C2\u6570\u5F00\u542F\u7684\u662F session \u53D8\u91CF\uFF0C\u6B64\u53D8\u91CF\u4E0D\u5EFA\u8BAE\u5168\u5C40\u5F00\u542F\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"--\u5F00\u542F\u53D8\u91CF\nmysql> set enable_profile=true;\nQuery OK, 0 rows affected (0.00 sec)\n\n--\u786E\u8BA4\u53D8\u91CF\u662F\u5426\u6B63\u5E38\u5F00\u542F\nmysql> show variables like '%profile%';\n+----------------+-------+---------------+---------+\n| Variable_name  | Value | Default_Value | Changed |\n+----------------+-------+---------------+---------+\n| enable_profile | true  | false         | 1       |\n+----------------+-------+---------------+---------+\n1 row in set (0.00 sec)\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u6267\u884C\u5BF9\u5E94 Query"}),"\n",(0,s.jsx)(n.p,{children:"\u96C6\u7FA4\u5728\u591A\u4E2A FE \u7684\u60C5\u51B5\u4E0B\uFF0C\u9700\u8981\u5230\u5F00\u542F Profile \u4E0A\u62A5\u53C2\u6570\u7684 FE \u4E0A\u6267\u884C\u5BF9\u5E94 Query, \u53C2\u6570\u5E76\u6CA1\u6709\u5168\u5C40\u751F\u6548\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"--\u5F00\u542F\u53D8\u91CF\nmysql> set enable_profile=true;\nQuery OK, 0 rows affected (0.00 sec)\n--\u786E\u8BA4\u53D8\u91CF\u662F\u5426\u6B63\u5E38\u5F00\u542F\nmysql> show variables like '%profile%';\n+----------------+-------+---------------+---------+\n| Variable_name  | Value | Default_Value | Changed |\n+----------------+-------+---------------+---------+\n| enable_profile | true  | false         | 1       |\n+----------------+-------+---------------+---------+\n1 row in set (0.00 sec)\n\n--\u6267\u884C\u5BF9\u5E94 Query\nmysql> select id,name from test.test where name like \"%RuO%\";\n+---------------------------+-------------------------------------------------------------------------------------------+\n| id                        | name                                                                                      |\n+---------------------------+-------------------------------------------------------------------------------------------+\n| 1ZWXYGbb8nr5Pi29J4cEMyEMb | ZN1nqzBRSl1rTrr99rnX1aplxhRuOUTLw6so7rzjlRQ317gTPxh0dHljmrARDJjH7FjRkJW9c7YuUBmWikq7eNgmFKJPreWirDrGrFzUYH4eP6kDtSA3UTnNIIj |\n+---------------------------+-------------------------------------------------------------------------------------------+\n1 row in set (0.01 sec)\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u83B7\u53D6 Profile"}),"\n",(0,s.jsx)(n.p,{children:"\u96C6\u7FA4\u5728\u591A\u4E2A FE \u7684\u60C5\u51B5\u4E0B\uFF0C\u9700\u8981\u8BBF\u95EE\u6267\u884C\u5BF9\u5E94 Query \u7684 FE HTTP \u754C\u9762 ( HTTP://FE_IP:HTTP_PORT ) \u7684 QueryProfile \u9875\u9762\uFF0C\u70B9\u51FB\u5BF9\u5E94 Profile ID \u67E5\u770B\u5BF9\u5E94 Profile\uFF0C\u8FD8\u53EF\u4EE5\u5728 Profile \u754C\u9762\u4E0B\u8F7D\u5BF9\u5E94 Profile\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"profile1.png",src:r(680537).Z+"",width:"1280",height:"256"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"profile2.png",src:r(605086).Z+"",width:"1280",height:"561"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"doris-\u96C6\u7FA4\u8BBF\u95EE\u5916\u7F51\u53D7\u5230\u9650\u5236",children:"Doris \u96C6\u7FA4\u8BBF\u95EE\u5916\u7F51\u53D7\u5230\u9650\u5236"}),"\n",(0,s.jsx)(n.p,{children:"\u96C6\u7FA4\u4E0D\u80FD\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51\u65F6\uFF0C\u9700\u8981\u901A\u8FC7 API \u7684\u65B9\u5F0F\u62FF\u5230\u5BF9\u5E94 Profile (HTTP://FE_IP:HTTP_PORT/API/Profile?Query_ID=),IP \u548C\u7AEF\u53E3\u662F\u6307\u6267\u884C\u5BF9\u5E94 Query \u7684 FE \u5BF9\u5E94 IP \u548C\u7AEF\u53E3\u3002\u6B64\u65F6\u83B7\u53D6\u5BF9\u5E94 Query \u7684 Profile \u6B65\u9AA4\u524D\u4E24\u6B65\u548C\u6B63\u5E38\u8BBF\u95EE\u5916\u7F51\u65F6\u662F\u4E00\u6837\u7684\uFF0C\u7B2C\u4E09\u6B65\u83B7\u53D6 Profile \u65F6\u4F1A\u6709\u5DEE\u522B\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u83B7\u53D6 Porfile"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u627E\u5230\u5BF9\u5E94 Query ID"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'--\u6839\u636E\u5BF9\u5E94 Query \u627E\u5230 Profile ID\nmysql> show query profile "/";\n+---------------------------+-----------+-------------------+-------------------+-------+------------+------+------------+---------------+\n| Profile ID                | Task Type | Start Time        | End Time          | Total | Task State | User | Default Db | Sql Statement  |\n+---------------------------+-----------+-------------------+-------------------+-------+------------+------+------------+---------------+\n| 1b0bb22689734d30-bbe56e17c2ff21dc | QUERY     | 2024-02-28 11:00:17 | 2024-02-28 11:00:17 | 7ms   | EOF        | root |            | select id,name from test.test where name like "%RuO%" |\n| 202fb174510c4772-965289e8f7f0cf10 | QUERY     | 2024-02-25 19:39:20 | 2024-02-25 19:39:20 | 19ms  | EOF        | root |            | select id,name from test.test where name like "%KJ%"  |\n+---------------------------+-----------+-------------------+-------------------+-------+------------+------+------------+---------------+\n2 rows in set (0.00 sec)\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u67E5\u8BE2 Profile \u5E76\u5C06 Profile \u91CD\u5B9A\u5411\u5230\u4E00\u4E2A\u6587\u672C\u4E2D"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"\u6A21\u677F\uFF1ACURL -X GET -u user:password http://fe_ip:http_port/api/profile?query_id=1b0bb22689734d30-bbe56e17c2ff21dc > test.profile\n\n[user@VM-10-6-centos profile]$ curl -X GET -u root:root http://127.0.0.1:8030/api/profile?query_id=1b0bb22689734d30-bbe56e17c2ff21dc > test.profile\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1211    0  1211    0     0   168k      0 --:--:-- --:--:-- --:--:--  168k\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u8FD4\u56DE\u7684 Profile \u6362\u884C\u7B26\u4E3A ",(0,s.jsx)(n.code,{children:"\\ \\n"})," \u5206\u6790\u8D77\u6765\u5F88\u4E0D\u65B9\u4FBF\uFF0C\u53EF\u4EE5\u5728\u6587\u672C\u7F16\u8F91\u5DE5\u5177\u4E2D\u5C06 ",(0,s.jsx)(n.code,{children:"\\ \\n"})," \u66FF\u6362\u4E3A ",(0,s.jsx)(n.code,{children:"\\n"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'[user@VM-10-6-centos profile]$ cat test.profile\n{"msg":"success","code":0,"data":{"profile":"Query:\\n  Summary:\\n     \n- Profile ID: 1b0bb22689734d30-bbe56e17c2ff21dc\\n     - Task Type: QUERY\\n     \n- Start Time: 2024-02-28 11:00:17\\n     - End Time: 2024-02-28 11:00:17\\n     \n- Total: 7ms\\n     - Task State: EOF\\n     - User: root\\n     - Default Db: \\n     \n- Sql Statement: select id,name from test.test where name like \\"%RuO%\\"\\n  Execution Summary:\\n     \n- Workload Group: \\n     - Analysis Time: 1ms\\n     \n- Plan Time: 2ms\\n       - JoinReorder Time: N/A\\n       \n- CreateSingleNode Time: N/A\\n       - QueryDistributed Time: N/A\\n       \n- Init Scan Node Time: N/A\\n       - Finalize Scan Node Time: N/A\\n         \n- Get Splits Time: N/A\\n           - Get PARTITIONS Time: N/A\\n           \n- Get PARTITION FILES Time: N/A\\n         - Create Scan Range Time: N/A\\n     \n- Schedule Time: N/A\\n     - Fetch Result Time: 0ms\\n     - Write Result Time: 0ms\\n     \n- Wait and Fetch Result Time: N/A\\n     - Doris Version: doris-2.0.4-rc06-003a815b63\\n     \n- Is Nereids: Yes\\n     - Is Pipeline: Yes\\n     - Is Cached: Yes\\n     \n- Total Instances Num: 0\\n     - Instances Num Per BE: \\n     \n- Parallel Fragment Exec Instance Num: 48\\n     - Trace ID: \\n"},"count":0}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u66FF\u6362\u540E\u7684\u6548\u679C\u5982\u4E0B"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{"msg":"success","code":0,"data":{"profile":"Query:\n  Summary:\n     - Profile ID: 1b0bb22689734d30-bbe56e17c2ff21dc\n     - Task Type: QUERY\n     - Start Time: 2024-02-28 11:00:17\n     - End Time: 2024-02-28 11:00:17\n     - Total: 7ms\n     - Task State: EOF\n     - User: root\n     - Default Db: \n     - Sql Statement: select id,name from test.test where name like \\"%RuO%\\"\n  Execution Summary:\n     - Workload Group: \n     - Analysis Time: 1ms\n     - Plan Time: 2ms\n       - JoinReorder Time: N/A\n       - CreateSingleNode Time: N/A\n       - QueryDistributed Time: N/A\n       - Init Scan Node Time: N/A\n       - Finalize Scan Node Time: N/A\n         - Get Splits Time: N/A\n           - Get PARTITIONS Time: N/A\n           - Get PARTITION FILES Time: N/A\n         - Create Scan Range Time: N/A\n     - Schedule Time: N/A\n     - Fetch Result Time: 0ms\n     - Write Result Time: 0ms\n     - Wait and Fetch Result Time: N/A\n     - Doris Version: doris-2.0.4-rc06-003a815b63\n     - Is Nereids: Yes\n     - Is Pipeline: Yes\n     - Is Cached: Yes\n     - Total Instances Num: 0\n     - Instances Num Per BE: \n     - Parallel Fragment Exec Instance Num: 48\n     - Trace ID: \n"},"count":0}\n'})}),"\n"]}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},680537:function(e,n,r){r.d(n,{Z:function(){return i}});let i=r.p+"assets/images/profile1-0d88983bffcec7c5bee8246e3271ef75.png"},605086:function(e,n,r){r.d(n,{Z:function(){return i}});let i=r.p+"assets/images/profile2-e869373c94cd09dae47ecfd3bbbca378.png"},250065:function(e,n,r){r.d(n,{Z:function(){return a},a:function(){return t}});var i=r(667294);let s={},l=i.createContext(s);function t(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);