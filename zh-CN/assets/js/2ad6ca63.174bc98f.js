"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["448150"],{144187:function(e,r,o){o.r(r),o.d(r,{default:()=>t,frontMatter:()=>s,metadata:()=>n,assets:()=>d,toc:()=>c,contentTitle:()=>i});var n=JSON.parse('{"id":"admin-manual/resource-admin/workload-group","title":"Workload Group","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.0/admin-manual/resource-admin/workload-group.md","sourceDirName":"admin-manual/resource-admin","slug":"/admin-manual/resource-admin/workload-group","permalink":"/zh-CN/docs/2.0/admin-manual/resource-admin/workload-group","draft":false,"unlisted":false,"tags":[],"version":"2.0","frontMatter":{"title":"Workload Group","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u4E3B\u952E\u8868\u6570\u636E\u4FEE\u590D","permalink":"/zh-CN/docs/2.0/admin-manual/data-admin/data-recovery"},"next":{"title":"Resource Group","permalink":"/zh-CN/docs/2.0/admin-manual/resource-admin/multi-tenant"}}'),l=o("785893"),a=o("250065");let s={title:"Workload Group",language:"zh-CN"},i=void 0,d={},c=[{value:"Workload Group \u5C5E\u6027",id:"workload-group-\u5C5E\u6027",level:2},{value:"Workload Group \u4F7F\u7528",id:"workload-group-\u4F7F\u7528",level:2},{value:"\u67E5\u8BE2\u6392\u961F\u529F\u80FD",id:"\u67E5\u8BE2\u6392\u961F\u529F\u80FD",level:3}];function u(e){let r={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.p,{children:"Workload Group \u53EF\u9650\u5236\u7EC4\u5185\u4EFB\u52A1\u5728\u5355\u4E2A BE \u8282\u70B9\u4E0A\u7684\u8BA1\u7B97\u8D44\u6E90\u548C\u5185\u5B58\u8D44\u6E90\u7684\u4F7F\u7528\u3002\u5F53\u524D\u652F\u6301 Query \u7ED1\u5B9A\u5230 Workload Group\u3002"}),"\n",(0,l.jsx)(r.h2,{id:"workload-group-\u5C5E\u6027",children:"Workload Group \u5C5E\u6027"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"cpu_share: \u5FC5\u9009\uFF0C\u7528\u4E8E\u8BBE\u7F6E Workload Group \u83B7\u53D6 CPU \u65F6\u95F4\u7684\u591A\u5C11\uFF0C\u53EF\u4EE5\u5B9E\u73B0 CPU \u8D44\u6E90\u8F6F\u9694\u79BB\u3002cpu_share \u662F\u76F8\u5BF9\u503C\uFF0C\u8868\u793A\u6B63\u5728\u8FD0\u884C\u7684 Workload Group \u53EF\u83B7\u53D6 cpu \u8D44\u6E90\u7684\u6743\u91CD\u3002\u4F8B\u5982\uFF0C\u7528\u6237\u521B\u5EFA\u4E86 3 \u4E2A Workload Group g-a\u3001g-b \u548C g-c\uFF0Ccpu_share \u5206\u522B\u4E3A 10\u300130\u300140\uFF0C\u67D0\u4E00\u65F6\u523B g-a \u548C g-b \u6B63\u5728\u8DD1\u4EFB\u52A1\uFF0C\u800C g-c \u6CA1\u6709\u4EFB\u52A1\uFF0C\u6B64\u65F6 g-a \u53EF\u83B7\u5F97 25% (10 / (10 + 30)) \u7684 cpu \u8D44\u6E90\uFF0C\u800C g-b \u53EF\u83B7\u5F97 75% \u7684 cpu \u8D44\u6E90\u3002\u5982\u679C\u7CFB\u7EDF\u53EA\u6709\u4E00\u4E2A Workload Group \u6B63\u5728\u8FD0\u884C\uFF0C\u5219\u4E0D\u7BA1\u5176 cpu_share \u7684\u503C\u4E3A\u591A\u5C11\uFF0C\u5B83\u90FD\u53EF\u83B7\u53D6\u5168\u90E8\u7684 cpu \u8D44\u6E90\u3002"}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsxs)(r.p,{children:["memory_limit: \u5FC5\u9009\uFF0C\u7528\u4E8E\u8BBE\u7F6E Workload Group \u53EF\u4EE5\u4F7F\u7528 be \u5185\u5B58\u7684\u767E\u5206\u6BD4\u3002Workload Group \u5185\u5B58\u9650\u5236\u7684\u7EDD\u5BF9\u503C\u4E3A\uFF1A",(0,l.jsx)(r.code,{children:"\u7269\u7406\u5185\u5B58 * mem_limit * memory_limit"}),"\uFF0C\u5176\u4E2D mem_limit \u4E3A be \u914D\u7F6E\u9879\u3002\u7CFB\u7EDF\u6240\u6709 Workload Group \u7684 memory_limit \u603B\u5408\u4E0D\u53EF\u8D85\u8FC7 100%\u3002Workload Group \u5728\u7EDD\u5927\u591A\u6570\u60C5\u51B5\u4E0B\u4FDD\u8BC1\u7EC4\u5185\u4EFB\u52A1\u53EF\u4F7F\u7528 memory_limit \u7684\u5185\u5B58\uFF0C\u5F53 Workload Group \u5185\u5B58\u4F7F\u7528\u8D85\u51FA\u8BE5\u9650\u5236\u540E\uFF0C\u7EC4\u5185\u5185\u5B58\u5360\u7528\u8F83\u5927\u7684\u4EFB\u52A1\u53EF\u80FD\u4F1A\u88AB cancel \u4EE5\u91CA\u653E\u8D85\u51FA\u7684\u5185\u5B58\uFF0C\u53C2\u8003 enable_memory_overcommit\u3002"]}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"enable_memory_overcommit: \u53EF\u9009\uFF0C\u7528\u4E8E\u5F00\u542F Workload Group \u5185\u5B58\u8F6F\u9694\u79BB\uFF0C\u9ED8\u8BA4\u4E3A false\u3002\u5982\u679C\u8BBE\u7F6E\u4E3A false\uFF0C\u5219\u8BE5 Workload Group \u4E3A\u5185\u5B58\u786C\u9694\u79BB\uFF0C\u7CFB\u7EDF\u68C0\u6D4B\u5230 Workload Group \u5185\u5B58\u4F7F\u7528\u8D85\u51FA\u9650\u5236\u540E\u5C06\u7ACB\u5373 cancel \u7EC4\u5185\u5185\u5B58\u5360\u7528\u6700\u5927\u7684\u82E5\u5E72\u4E2A\u4EFB\u52A1\uFF0C\u4EE5\u91CA\u653E\u8D85\u51FA\u7684\u5185\u5B58\uFF1B\u5982\u679C\u8BBE\u7F6E\u4E3A true\uFF0C\u5219\u8BE5 Workload Group \u4E3A\u5185\u5B58\u8F6F\u9694\u79BB\uFF0C\u5982\u679C\u7CFB\u7EDF\u6709\u7A7A\u95F2\u5185\u5B58\u8D44\u6E90\u5219\u8BE5 Workload Group \u5728\u8D85\u51FA memory_limit \u7684\u9650\u5236\u540E\u53EF\u7EE7\u7EED\u4F7F\u7528\u7CFB\u7EDF\u5185\u5B58\uFF0C\u5728\u7CFB\u7EDF\u603B\u5185\u5B58\u7D27\u5F20\u65F6\u4F1A cancel \u7EC4\u5185\u5185\u5B58\u5360\u7528\u6700\u5927\u7684\u82E5\u5E72\u4E2A\u4EFB\u52A1\uFF0C\u91CA\u653E\u90E8\u5206\u8D85\u51FA\u7684\u5185\u5B58\u4EE5\u7F13\u89E3\u7CFB\u7EDF\u5185\u5B58\u538B\u529B\u3002\u5EFA\u8BAE\u5728\u6709 Workload Group \u5F00\u542F\u8BE5\u914D\u7F6E\u65F6\uFF0C\u6240\u6709 Workload Group \u7684 memory_limit \u603B\u548C\u4F4E\u4E8E 100%\uFF0C\u5269\u4F59\u90E8\u5206\u7528\u4E8E Workload Group \u5185\u5B58\u8D85\u53D1\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"workload-group-\u4F7F\u7528",children:"Workload Group \u4F7F\u7528"}),"\n",(0,l.jsxs)(r.ol,{children:["\n",(0,l.jsxs)(r.li,{children:["\u624B\u52A8\u521B\u5EFA\u540D\u4E3A",(0,l.jsx)(r.code,{children:"normal"}),"\u7684Workload Group\uFF0C\u8BE5Group\u4E0D\u53EF\u5220\u9664\u3002\u4E5F\u53EF\u4EE5\u5728\u6253\u5F00Workload Group\u5F00\u5173\u540E\u91CD\u542FFE\uFF0C\u4F1A\u81EA\u52A8\u521B\u5EFA\u8FD9\u4E2AGroup\u3002"]}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'create workload group if not exists normal\nproperties (\n    "cpu_share"="10",\n    "memory_limit"="30%",\n    "enable_memory_overcommit"="true"\n);\n'})}),"\n",(0,l.jsxs)(r.ol,{start:"2",children:["\n",(0,l.jsx)(r.li,{children:"\u5F00\u542F experimental_enable_workload_group \u914D\u7F6E\u9879\uFF0C\u5728 fe.conf \u4E2D\u8BBE\u7F6E\uFF1A"}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-shell",children:"experimental_enable_workload_group=true\n"})}),"\n",(0,l.jsxs)(r.ol,{start:"3",children:["\n",(0,l.jsx)(r.li,{children:"\u521B\u5EFA Workload Group\uFF1A"}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'create workload group if not exists g1\nproperties (\n    "cpu_share"="10",\n    "memory_limit"="30%",\n    "enable_memory_overcommit"="true"\n);\n'})}),"\n",(0,l.jsxs)(r.p,{children:["\u521B\u5EFA workload group \u8BE6\u7EC6\u53EF\u53C2\u8003\uFF1A",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Data-Definition-Statements/Create/CREATE-WORKLOAD-GROUP",children:"CREATE-WORKLOAD-GROUP"}),"\uFF0C\u53E6\u5220\u9664 Workload Group \u53EF\u53C2\u8003",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Data-Definition-Statements/Drop/DROP-WORKLOAD-GROUP",children:"DROP-WORKLOAD-GROUP"}),"\uFF1B\u4FEE\u6539 Workload Group \u53EF\u53C2\u8003\uFF1A",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-WORKLOAD-GROUP",children:"ALTER-WORKLOAD-GROUP"}),"\uFF1B\u67E5\u770B Workload Group \u53EF\u53C2\u8003\uFF1A",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-functions/table-functions/workload-group",children:"WORKLOAD_GROUPS()"}),"\u548C",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Show-Statements/SHOW-WORKLOAD-GROUPS",children:"SHOW-WORKLOAD-GROUPS"}),"\u3002"]}),"\n",(0,l.jsxs)(r.ol,{start:"4",children:["\n",(0,l.jsx)(r.li,{children:"\u5F00\u542F Pipeline \u6267\u884C\u5F15\u64CE\uFF0CWorkload Group CPU \u9694\u79BB\u57FA\u4E8E Pipeline \u6267\u884C\u5F15\u64CE\u5B9E\u73B0\uFF0C\u56E0\u6B64\u9700\u5F00\u542F Session \u53D8\u91CF\uFF1A"}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-shell",children:"set experimental_enable_pipeline_engine = true;\n"})}),"\n",(0,l.jsxs)(r.ol,{start:"5",children:["\n",(0,l.jsx)(r.li,{children:"\u7ED1\u5B9A Workload Group\u3002"}),"\n"]}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["\u901A\u8FC7\u8BBE\u7F6E user property \u5C06 user \u9ED8\u8BA4\u7ED1\u5B9A\u5230 workload group\uFF0C\u9ED8\u8BA4\u4E3A",(0,l.jsx)(r.code,{children:"normal"}),":"]}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"set property 'default_workload_group' = 'g1';\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u5F53\u524D\u7528\u6237\u7684\u67E5\u8BE2\u5C06\u9ED8\u8BA4\u4F7F\u7528'g1'\u3002"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"\u901A\u8FC7 session \u53D8\u91CF\u6307\u5B9A workload group, \u9ED8\u8BA4\u4E3A\u7A7A\uFF1A"}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"set workload_group = 'g2';\n"})}),"\n",(0,l.jsxs)(r.p,{children:["session \u53D8\u91CF",(0,l.jsx)(r.code,{children:"workload_group"}),"\u4F18\u5148\u4E8E user property ",(0,l.jsx)(r.code,{children:"default_workload_group"}),", \u5728",(0,l.jsx)(r.code,{children:"workload_group"}),"\u4E3A\u7A7A\u65F6\uFF0C\u67E5\u8BE2\u5C06\u7ED1\u5B9A\u5230",(0,l.jsx)(r.code,{children:"default_workload_group"}),", \u5728 session \u53D8\u91CF",(0,l.jsx)(r.code,{children:"workload_group"}),"\u4E0D\u4E3A\u7A7A\u65F6\uFF0C\u67E5\u8BE2\u5C06\u7ED1\u5B9A\u5230",(0,l.jsx)(r.code,{children:"workload_group"}),"\u3002"]}),"\n",(0,l.jsxs)(r.p,{children:["\u5982\u679C\u662F\u975E Admin \u7528\u6237\uFF0C\u9700\u8981\u5148\u6267\u884C",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Show-Statements/SHOW-WORKLOAD-GROUPS",children:"SHOW-WORKLOAD-GROUPS"})," \u786E\u8BA4\u4E0B\u5F53\u524D\u7528\u6237\u80FD\u5426\u770B\u5230\u8BE5 workload group\uFF0C\u4E0D\u80FD\u770B\u5230\u7684 workload group \u53EF\u80FD\u4E0D\u5B58\u5728\u6216\u8005\u5F53\u524D\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF0C\u6267\u884C\u67E5\u8BE2\u65F6\u4F1A\u62A5\u9519\u3002\u7ED9 worklaod group \u6388\u6743\u53C2\u8003\uFF1A",(0,l.jsx)(r.a,{href:"../../sql-manual/sql-reference/Account-Management-Statements/GRANT",children:"grant \u8BED\u53E5"}),"\u3002"]}),"\n",(0,l.jsxs)(r.ol,{start:"6",children:["\n",(0,l.jsx)(r.li,{children:"\u6267\u884C\u67E5\u8BE2\uFF0C\u67E5\u8BE2\u5C06\u5173\u8054\u5230\u6307\u5B9A\u7684 Workload Group\u3002"}),"\n"]}),"\n",(0,l.jsx)(r.h3,{id:"\u67E5\u8BE2\u6392\u961F\u529F\u80FD",children:"\u67E5\u8BE2\u6392\u961F\u529F\u80FD"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'create workload group if not exists test_group\nproperties (\n    "cpu_share"="10",\n    "memory_limit"="30%",\n    "max_concurrency" = "10",\n    "max_queue_size" = "20",\n    "queue_timeout" = "3000"\n);\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u76EE\u524D\u7684 workload group \u652F\u6301\u67E5\u8BE2\u6392\u961F\u7684\u529F\u80FD\uFF0C\u53EF\u4EE5\u5728\u65B0\u5EFA group \u65F6\u8FDB\u884C\u6307\u5B9A\uFF0C\u9700\u8981\u4EE5\u4E0B\u4E09\u4E2A\u53C2\u6570\uFF1A"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"max_concurrency\uFF0C\u5F53\u524D group \u5141\u8BB8\u7684\u6700\u5927\u67E5\u8BE2\u6570;\u8D85\u8FC7\u6700\u5927\u5E76\u53D1\u7684\u67E5\u8BE2\u5230\u6765\u65F6\u4F1A\u8FDB\u5165\u6392\u961F\u903B\u8F91"}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"max_queue_size\uFF0C\u67E5\u8BE2\u6392\u961F\u7684\u957F\u5EA6;\u5F53\u961F\u5217\u6EE1\u4E86\u4E4B\u540E\uFF0C\u65B0\u6765\u7684\u67E5\u8BE2\u4F1A\u88AB\u62D2\u7EDD"}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"queue_timeout\uFF0C\u67E5\u8BE2\u5728\u961F\u5217\u4E2D\u7B49\u5F85\u7684\u65F6\u95F4\uFF0C\u5982\u679C\u67E5\u8BE2\u7B49\u5F85\u65F6\u95F4\u8D85\u8FC7\u8FD9\u4E2A\u503C\uFF0C\u90A3\u4E48\u67E5\u8BE2\u4F1A\u88AB\u62D2\u7EDD\uFF0C\u65F6\u95F4\u5355\u4F4D\u4E3A\u6BEB\u79D2"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(r.p,{children:"\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u76EE\u524D\u7684\u6392\u961F\u8BBE\u8BA1\u662F\u4E0D\u611F\u77E5 FE \u7684\u4E2A\u6570\u7684\uFF0C\u6392\u961F\u7684\u53C2\u6570\u53EA\u5728\u5355 FE \u7C92\u5EA6\u751F\u6548\uFF0C\u4F8B\u5982\uFF1A"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"\u4E00\u4E2A Doris \u96C6\u7FA4\u914D\u7F6E\u4E86\u4E00\u4E2A Workload Group\uFF0C\u8BBE\u7F6E max_concurrency = 1"}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"\u5982\u679C\u96C6\u7FA4\u4E2D\u6709 1FE\uFF0C\u90A3\u4E48\u8FD9\u4E2A Workload Group \u5728 Doris \u96C6\u7FA4\u89C6\u89D2\u770B\u540C\u65F6\u53EA\u4F1A\u8FD0\u884C\u4E00\u4E2A SQL"}),"\n"]}),"\n",(0,l.jsxs)(r.li,{children:["\n",(0,l.jsx)(r.p,{children:"\u5982\u679C\u6709 3 \u53F0 FE\uFF0C\u90A3\u4E48\u5728 Doris \u96C6\u7FA4\u89C6\u89D2\u770B\u6700\u5927\u53EF\u8FD0\u884C\u7684 SQL \u4E2A\u6570\u4E3A 3"}),"\n"]}),"\n"]})]})}function t(e={}){let{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},250065:function(e,r,o){o.d(r,{Z:function(){return i},a:function(){return s}});var n=o(667294);let l={},a=n.createContext(l);function s(e){let r=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);