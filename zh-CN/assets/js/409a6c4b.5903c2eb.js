"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["848673"],{256329:function(e,n,s){s.r(n),s.d(n,{default:()=>p,frontMatter:()=>c,metadata:()=>r,assets:()=>a,toc:()=>o,contentTitle:()=>l});var r=JSON.parse('{"id":"admin-manual/auth/certificate","title":"MySQL \u5B89\u5168\u4F20\u8F93","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/admin-manual/auth/certificate.md","sourceDirName":"admin-manual/auth","slug":"/admin-manual/auth/certificate","permalink":"/zh-CN/docs/dev/admin-manual/auth/certificate","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"MySQL \u5B89\u5168\u4F20\u8F93","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u5BA1\u8BA1\u65E5\u5FD7","permalink":"/zh-CN/docs/dev/admin-manual/audit-plugin"},"next":{"title":"HTTP \u5B89\u5168\u4F20\u8F93","permalink":"/zh-CN/docs/dev/admin-manual/auth/fe-certificate"}}'),t=s("785893"),i=s("250065");let c={title:"MySQL \u5B89\u5168\u4F20\u8F93",language:"zh-CN"},l=void 0,a={},o=[{value:"\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6",id:"\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Doris \u5F00\u542F SSL \u529F\u80FD\u9700\u8981\u914D\u7F6E CA \u5BC6\u94A5\u8BC1\u4E66\u548C Server \u7AEF\u5BC6\u94A5\u8BC1\u4E66\uFF0C\u5982\u9700\u5F00\u542F\u53CC\u5411\u8BA4\u8BC1\uFF0C\u8FD8\u9700\u751F\u6210 Client \u7AEF\u5BC6\u94A5\u8BC1\u4E66\uFF1A"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u9ED8\u8BA4\u7684 CA \u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\u4F4D\u4E8E",(0,t.jsx)(n.code,{children:"Doris/fe/mysql_ssl_default_certificate/ca_certificate.p12"}),"\uFF0C\u9ED8\u8BA4\u5BC6\u7801\u4E3A",(0,t.jsx)(n.code,{children:"doris"}),"\uFF0C\u60A8\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539 FE \u914D\u7F6E\u6587\u4EF6",(0,t.jsx)(n.code,{children:"conf/fe.conf"}),"\uFF0C\u6DFB\u52A0",(0,t.jsx)(n.code,{children:"mysql_ssl_default_ca_certificate = /path/to/your/certificate"}),"\u4FEE\u6539 CA \u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\uFF0C\u540C\u65F6\u4E5F\u53EF\u4EE5\u901A\u8FC7",(0,t.jsx)(n.code,{children:"mysql_ssl_default_ca_certificate_password = your_password"}),"\u6DFB\u52A0\u5BF9\u5E94\u60A8\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\u7684\u5BC6\u7801\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u9ED8\u8BA4\u7684 Server \u7AEF\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\u4F4D\u4E8E",(0,t.jsx)(n.code,{children:"Doris/fe/mysql_ssl_default_certificate/server_certificate.p12"}),"\uFF0C\u9ED8\u8BA4\u5BC6\u7801\u4E3A",(0,t.jsx)(n.code,{children:"doris"}),"\uFF0C\u60A8\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539 FE \u914D\u7F6E\u6587\u4EF6",(0,t.jsx)(n.code,{children:"conf/fe.conf"}),"\uFF0C\u6DFB\u52A0",(0,t.jsx)(n.code,{children:"mysql_ssl_default_server_certificate = /path/to/your/certificate"}),"\u4FEE\u6539 Server \u7AEF\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\uFF0C\u540C\u65F6\u4E5F\u53EF\u4EE5\u901A\u8FC7",(0,t.jsx)(n.code,{children:"mysql_ssl_default_server_certificate_password = your_password"}),"\u6DFB\u52A0\u5BF9\u5E94\u60A8\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6\u7684\u5BC6\u7801\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u9ED8\u8BA4\u751F\u6210\u4E86\u4E00\u4EFD Client \u7AEF\u7684\u5BC6\u94A5\u8BC1\u4E66\uFF0C\u5206\u522B\u5B58\u653E\u5728",(0,t.jsx)(n.code,{children:"Doris/fe/mysql_ssl_default_certificate/client-key.pem"}),"\u548C",(0,t.jsx)(n.code,{children:"Doris/fe/mysql_ssl_default_certificate/client_certificate/"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6",children:"\u81EA\u5B9A\u4E49\u5BC6\u94A5\u8BC1\u4E66\u6587\u4EF6"}),"\n",(0,t.jsxs)(n.p,{children:["\u9664\u4E86 Doris \u9ED8\u8BA4\u7684\u8BC1\u4E66\u6587\u4EF6\uFF0C\u60A8\u4E5F\u53EF\u4EE5\u901A\u8FC7",(0,t.jsx)(n.code,{children:"openssl"}),"\u751F\u6210\u81EA\u5B9A\u4E49\u7684\u8BC1\u4E66\u6587\u4EF6\u3002\u6B65\u9AA4\u53C2\u8003",(0,t.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/creating-ssl-files-using-openssl.html",children:"MySQL \u751F\u6210 SSL \u8BC1\u4E66"}),"\n\u5177\u4F53\u5982\u4E0B\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"\u751F\u6210 CA\u3001Server \u7AEF\u548C Client \u7AEF\u7684\u5BC6\u94A5\u548C\u8BC1\u4E66"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# \u751F\u6210 CA certificate\nopenssl genrsa 2048 > ca-key.pem\nopenssl req -new -x509 -nodes -days 3600 \\\n        -key ca-key.pem -out ca.pem\n\n# \u751F\u6210 server certificate, \u5E76\u7528\u4E0A\u8FF0 CA \u7B7E\u540D\n# server-cert.pem = public key, server-key.pem = private key\nopenssl req -newkey rsa:2048 -days 3600 \\\n        -nodes -keyout server-key.pem -out server-req.pem\nopenssl rsa -in server-key.pem -out server-key.pem\nopenssl x509 -req -in server-req.pem -days 3600 \\\n        -CA ca.pem -CAkey ca-key.pem -set_serial 01 -out server-cert.pem\n\n# \u751F\u6210 client certificate, \u5E76\u7528\u4E0A\u8FF0 CA \u7B7E\u540D\n# client-cert.pem = public key, client-key.pem = private key\nopenssl req -newkey rsa:2048 -days 3600 \\\n        -nodes -keyout client-key.pem -out client-req.pem\nopenssl rsa -in client-key.pem -out client-key.pem\nopenssl x509 -req -in client-req.pem -days 3600 \\\n        -CA ca.pem -CAkey ca-key.pem -set_serial 01 -out client-cert.pem\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"\u9A8C\u8BC1\u521B\u5EFA\u7684\u8BC1\u4E66\u3002"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"openssl verify -CAfile ca.pem server-cert.pem client-cert.pem\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"\u5C06\u60A8\u7684 CA \u5BC6\u94A5\u548C\u8BC1\u4E66\u548C Server \u7AEF\u5BC6\u94A5\u548C\u8BC1\u4E66\u5206\u522B\u5408\u5E76\u5230 PKCS#12 (P12) \u5305\u4E2D\u3002\u60A8\u4E5F\u53EF\u4EE5\u6307\u5B9A\u67D0\u4E2A\u8BC1\u4E66\u683C\u5F0F\uFF0C\u9ED8\u8BA4 PKCS12\uFF0C\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539 conf/fe.conf \u914D\u7F6E\u6587\u4EF6\uFF0C\u6DFB\u52A0\u53C2\u6570 ssl_trust_store_type \u6307\u5B9A\u8BC1\u4E66\u683C\u5F0F"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# \u6253\u5305 CA \u5BC6\u94A5\u548C\u8BC1\u4E66\nopenssl pkcs12 -inkey ca-key.pem -in ca.pem -export -out ca_certificate.p12\n\n# \u6253\u5305 Server \u7AEF\u5BC6\u94A5\u548C\u8BC1\u4E66\nopenssl pkcs12 -inkey server-key.pem -in server-cert.pem -export -out server_certificate.p12\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Note",type:"info",children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://www.ibm.com/docs/en/api-connect/2018.x?topic=overview-generating-self-signed-certificate-using-openssl",children:"\u53C2\u8003\u6587\u6863"})})})]})}function p(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return l},a:function(){return c}});var r=s(667294);let t={},i=r.createContext(t);function c(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);