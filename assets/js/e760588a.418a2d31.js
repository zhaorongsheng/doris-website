"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["532050"],{613781:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>r,assets:()=>s,toc:()=>o,contentTitle:()=>d});var r=JSON.parse('{"id":"lakehouse/catalogs/delta-lake-catalog","title":"Delta Lake Catalog","description":"\x3c!--","source":"@site/docs/lakehouse/catalogs/delta-lake-catalog.md","sourceDirName":"lakehouse/catalogs","slug":"/lakehouse/catalogs/delta-lake-catalog","permalink":"/docs/dev/lakehouse/catalogs/delta-lake-catalog","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Delta Lake Catalog","language":"en"},"sidebar":"docs","previous":{"title":"MaxCompute Catalog","permalink":"/docs/dev/lakehouse/catalogs/maxcompute-catalog"},"next":{"title":"BigQuery Catalog","permalink":"/docs/dev/lakehouse/catalogs/bigquery-catalog"}}'),l=t("785893"),i=t("250065");let a={title:"Delta Lake Catalog",language:"en"},d=void 0,s={},o=[{value:"Application Scenarios",id:"application-scenarios",level:2},{value:"Environment Preparation",id:"environment-preparation",level:2},{value:"Compile the Delta Lake Connector Plugin",id:"compile-the-delta-lake-connector-plugin",level:3},{value:"Deploy the Delta Lake Connector",id:"deploy-the-delta-lake-connector",level:3},{value:"Configuring Catalog",id:"configuring-catalog",level:2},{value:"Syntax",id:"syntax",level:3},{value:"Supported Delta Lake Versions",id:"supported-delta-lake-versions",level:3},{value:"Supported Metadata Services",id:"supported-metadata-services",level:3},{value:"Supported Storage Systems",id:"supported-storage-systems",level:3},{value:"Column Type Mapping",id:"column-type-mapping",level:2},{value:"Examples",id:"examples",level:2},{value:"Query Operations",id:"query-operations",level:2}];function c(e){let n={a:"a",blockquote:"blockquote",code:"code",div:"div",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:["Delta Lake Catalog uses the ",(0,l.jsx)(n.a,{href:"https://doris.apache.org/zh-CN/community/how-to-contribute/trino-connector-developer-guide/",children:"Trino Connector"})," compatibility framework to access Delta Lake tables through the Delta Lake Connector."]}),"\n",(0,l.jsx)(n.div,{children:(0,l.jsx)(n.p,{children:"This feature is experimental and has been supported since version 3.0.1."})}),"\n",(0,l.jsx)(n.h2,{id:"application-scenarios",children:"Application Scenarios"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Scenario"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Data Integration"}),(0,l.jsx)(n.td,{children:"Read Delta Lake data and write it into Doris internal tables."})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Data Writeback"}),(0,l.jsx)(n.td,{children:"Not supported."})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"environment-preparation",children:"Environment Preparation"}),"\n",(0,l.jsx)(n.h3,{id:"compile-the-delta-lake-connector-plugin",children:"Compile the Delta Lake Connector Plugin"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"JDK 17 is required."}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ git clone https://github.com/apache/doris-thirdparty.git\n$ cd doris-thirdparty\n$ git checkout trino-435\n$ cd plugin/trino-delta-lake\n$ mvn clean install -DskipTest\n$ cd ../../lib/trino-hdfs\n$ mvn clean install -DskipTest\n"})}),"\n",(0,l.jsxs)(n.p,{children:["After compiling, you will find the ",(0,l.jsx)(n.code,{children:"trino-delta-lake-435"})," directory under ",(0,l.jsx)(n.code,{children:"trino/plugin/trino-delta-lake/target/"})," and the ",(0,l.jsx)(n.code,{children:"hdfs"})," directory under ",(0,l.jsx)(n.code,{children:"trino/lib/trino-hdfs/target/"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["You can also directly download the precompiled ",(0,l.jsx)(n.a,{href:"https://github.com/apache/Doris-thirdparty/releases/download/trino-435-20240724/trino-delta-lake-435-20240724.tar.gz",children:"trino-delta-lake-435-20240724.tar.gz"})," and ",(0,l.jsx)(n.a,{href:"https://github.com/apache/doris-thirdparty/releases/download/trino-435-20240724/trino-hdfs-435-20240724.tar.gz",children:"hdfs.tar.gz"}),", then extract them."]}),"\n",(0,l.jsx)(n.h3,{id:"deploy-the-delta-lake-connector",children:"Deploy the Delta Lake Connector"}),"\n",(0,l.jsxs)(n.p,{children:["Place the ",(0,l.jsx)(n.code,{children:"trino-delta-lake-435/"})," directory in the ",(0,l.jsx)(n.code,{children:"connectors/"})," directory of all FE and BE deployment paths(If it does not exist, you can create it manually) and extract ",(0,l.jsx)(n.code,{children:"hdfs.tar.gz"})," into the ",(0,l.jsx)(n.code,{children:"trino-delta-lake-435/"})," directory."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"\u251C\u2500\u2500 bin\n\u251C\u2500\u2500 conf\n\u251C\u2500\u2500 connectors\n\u2502   \u251C\u2500\u2500 trino-delta-lake-435\n\u2502   \u2502   \u251C\u2500\u2500 hdfs\n...\n"})}),"\n",(0,l.jsx)(n.p,{children:"After deployment, it is recommended to restart the FE and BE nodes to ensure the Connector is loaded correctly."}),"\n",(0,l.jsx)(n.h2,{id:"configuring-catalog",children:"Configuring Catalog"}),"\n",(0,l.jsx)(n.h3,{id:"syntax",children:"Syntax"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"CREATE CATALOG [IF NOT EXISTS] catalog_name\nPROPERTIES (\n    'type' = 'trino-connector', -- required\n    'trino.connector.name' = 'delta_lake', -- required\n    {TrinoProperties},\n    {CommonProperties}\n);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"{TrinoProperties}"})}),"\n",(0,l.jsxs)(n.p,{children:["The TrinoProperties section is used to specify properties that will be passed to the Trino Connector. These properties use the ",(0,l.jsx)(n.code,{children:"trino."})," prefix. In theory, all properties supported by Trino are also supported here. For more information about Delta Lake, refer to the ",(0,l.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino documentation"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"{CommonProperties}"})}),"\n",(0,l.jsxs)(n.p,{children:["The CommonProperties section is used to specify general properties. Please refer to the ",(0,l.jsx)(n.a,{href:"/docs/dev/lakehouse/catalog-overview",children:"Catalog Overview"}),' under the "Common Properties" section.']}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"supported-delta-lake-versions",children:"Supported Delta Lake Versions"}),"\n",(0,l.jsxs)(n.p,{children:["For more information about Delta Lake, refer to the ",(0,l.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino documentation"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"supported-metadata-services",children:"Supported Metadata Services"}),"\n",(0,l.jsxs)(n.p,{children:["For more information about Delta Lake, refer to the ",(0,l.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino documentation"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"supported-storage-systems",children:"Supported Storage Systems"}),"\n",(0,l.jsxs)(n.p,{children:["For more information about Delta Lake, refer to the ",(0,l.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino documentation"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"column-type-mapping",children:"Column Type Mapping"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Delta Lake Type"}),(0,l.jsx)(n.th,{children:"Trino Type"}),(0,l.jsx)(n.th,{children:"Doris Type"}),(0,l.jsx)(n.th,{children:"Comment"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"boolean"}),(0,l.jsx)(n.td,{children:"boolean"}),(0,l.jsx)(n.td,{children:"boolean"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"byte"}),(0,l.jsx)(n.td,{children:"tinyint"}),(0,l.jsx)(n.td,{children:"tinyint"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"short"}),(0,l.jsx)(n.td,{children:"smallint"}),(0,l.jsx)(n.td,{children:"smallint"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"long"}),(0,l.jsx)(n.td,{children:"bigint"}),(0,l.jsx)(n.td,{children:"bigint"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"float"}),(0,l.jsx)(n.td,{children:"real"}),(0,l.jsx)(n.td,{children:"float"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"double"}),(0,l.jsx)(n.td,{children:"double"}),(0,l.jsx)(n.td,{children:"double"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"decimal(P, S)"}),(0,l.jsx)(n.td,{children:"decimal(P, S)"}),(0,l.jsx)(n.td,{children:"decimal(P, S)"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:"varchar"}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"bianry"}),(0,l.jsx)(n.td,{children:"varbinary"}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"date"}),(0,l.jsx)(n.td,{children:"date"}),(0,l.jsx)(n.td,{children:"date"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"timestamp_ntz"}),(0,l.jsx)(n.td,{children:"timestamp(N)"}),(0,l.jsx)(n.td,{children:"datetime(N)"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"timestamp"}),(0,l.jsx)(n.td,{children:"timestamp with time zone(N)"}),(0,l.jsx)(n.td,{children:"datetime(N)"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"array"}),(0,l.jsx)(n.td,{children:"array"}),(0,l.jsx)(n.td,{children:"array"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"map"}),(0,l.jsx)(n.td,{children:"map"}),(0,l.jsx)(n.td,{children:"map"}),(0,l.jsx)(n.td,{})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"struct"}),(0,l.jsx)(n.td,{children:"row"}),(0,l.jsx)(n.td,{children:"struct"}),(0,l.jsx)(n.td,{})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"CREATE CATALOG delta_lake_hms properties ( \n    'type' = 'trino-connector', \n    'trino.connector.name' = 'delta_lake',\n    'trino.hive.metastore' = 'thrift',\n    'trino.hive.metastore.uri'= 'thrift://ip:port',\n    'trino.hive.config.resources'='/path/to/core-site.xml,/path/to/hdfs-site.xml'\n);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"query-operations",children:"Query Operations"}),"\n",(0,l.jsx)(n.p,{children:"After configuring the Catalog, you can query the table data in the Catalog using the following methods:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"-- 1. Switch to the catalog, use the database, and query\nSWITCH delta_lake_ctl;\nUSE delta_lake_db;\nSELECT * FROM delta_lake_tbl LIMIT 10;\n\n-- 2. Use the Delta Lake database directly\nUSE delta_lake_ctl.delta_lake_db;\nSELECT * FROM delta_lake_tbl LIMIT 10;\n\n-- 3. Use the fully qualified name to query\nSELECT * FROM delta_lake_ctl.delta_lake_db.delta_lake_tbl LIMIT 10;\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return d},a:function(){return a}});var r=t(667294);let l={},i=r.createContext(l);function a(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);